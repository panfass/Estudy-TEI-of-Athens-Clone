
CREATE SCHEMA IF NOT EXISTS foititologio DEFAULT CHARACTER SET latin1;
USE foititologio;

CREATE TABLE IF NOT EXISTS login (
  User_ID INT NOT NULL AUTO_INCREMENT,
  Username VARCHAR(20) NOT NULL,
  Password VARCHAR(30) NOT NULL,
  CONSTRAINT uc_login UNIQUE (Username,Password),
  PRIMARY KEY (User_ID));

CREATE TABLE IF NOT EXISTS ROLE (
  Role_ID INT NOT NULL AUTO_INCREMENT,
  Description VARCHAR(45) NOT NULL,
  PRIMARY KEY (Role_ID));

CREATE TABLE IF NOT EXISTS foithths (
  ID_FOITHTHS INT NOT NULL,
  Name VARCHAR(30) NOT NULL,
  Surname VARCHAR(30) NOT NULL,
  Semester INT NOT NULL,
  AM VARCHAR(10) NOT NULL UNIQUE,
  CONSTRAINT ID_FOITHTHS1
    FOREIGN KEY (ID_FOITHTHS)
    REFERENCES login (User_ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS mathimata (
  MATHIMATA_ID INT NOT NULL AUTO_INCREMENT,
  MATHIMA_Name VARCHAR(45) NOT NULL,
  Semester VARCHAR(45) NOT NULL,
  CONSTRAINT uc_MATHIMA UNIQUE (MATHIMA_Name,Semester),
  PRIMARY KEY (MATHIMATA_ID));

CREATE TABLE IF NOT EXISTS grade(
  Grade DECIMAL NULL,
  MATHIMATA_ID INT NOT NULL,
  ID_FOITHTHS INT NOT NULL,
  INDEX MATHIMATA_ID_idx (MATHIMATA_ID ASC),
  INDEX ID_FOITHTHS_idx (ID_FOITHTHS ASC),
  CONSTRAINT MATHIMATA_ID
    FOREIGN KEY (MATHIMATA_ID)
    REFERENCES mathimata (MATHIMATA_ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT ID_FOITHTHS2
    FOREIGN KEY (ID_FOITHTHS)
    REFERENCES foithths (ID_FOITHTHS)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


CREATE TABLE IF NOT EXISTS USER_ROLE_ID (
  User_ID INT NOT NULL,
  Role_ID INT NOT NULL,
  INDEX User_ID_idx (User_ID ASC),
  INDEX Role_ID_idx (Role_ID ASC),
  CONSTRAINT User_ID
    FOREIGN KEY (User_ID)
    REFERENCES login (User_ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT Role_ID1
    FOREIGN KEY (Role_ID)
    REFERENCES ROLE (Role_ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


INSERT INTO login (User_ID, Username, Password) VALUES (1, '1', '1');
INSERT INTO login (User_ID, Username, Password) VALUES (2, '2', '2');
INSERT INTO login (User_ID, Username, Password) VALUES (3, '3', '3');

INSERT INTO ROLE (Role_ID, Description) VALUES ( 1, 'Student');
INSERT INTO ROLE (Role_ID, Description) VALUES ( 2, 'Grammateia');
INSERT INTO ROLE (Role_ID, Description) VALUES ( 3, 'Administrator');

INSERT INTO USER_ROLE_ID (User_ID, Role_ID) VALUES ( 1, 1 );
INSERT INTO USER_ROLE_ID (User_ID, Role_ID) VALUES ( 2, 2 );
INSERT INTO USER_ROLE_ID (User_ID, Role_ID) VALUES ( 3, 3 );

INSERT INTO foithths (ID_FOITHTHS, Name, Surname, Semester, AM) VALUES (1, 'Mike1', 'Papa1', 7, '101');
INSERT INTO foithths (ID_FOITHTHS, Name, Surname, Semester, AM) VALUES (2, 'Mike2', 'Papa2', 8, '102');

INSERT INTO mathimata (MATHIMATA_ID, MATHIMA_Name, Semester) VALUES (1, 'Programming', 3);
INSERT INTO mathimata (MATHIMATA_ID, MATHIMA_Name, Semester) VALUES (2, 'Architecture', 4);

INSERT INTO grade (Grade, MATHIMATA_ID, ID_FOITHTHS) VALUES (7, 1, 1);
INSERT INTO grade (Grade, MATHIMATA_ID, ID_FOITHTHS) VALUES (8, 2, 1);
INSERT INTO grade (Grade, MATHIMATA_ID, ID_FOITHTHS) VALUES (5, 1, 2);
INSERT INTO grade (Grade, MATHIMATA_ID, ID_FOITHTHS) VALUES (6, 2, 2);